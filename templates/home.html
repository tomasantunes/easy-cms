<!DOCTYPE html>
<html lang="en">
<head>
	{% include 'header.html' %}
	{% block header %}
	{% endblock %}
</head>
<body>
	<div class="top-nav" id="top-nav1">
	  <a href="/" class="active">Home</a>
	  <a href="/admin">Admin</a>
	  <a href="/login">Login</a>
	  <a href="/signup">Sign Up</a>
	  <a href="/logout">Logout</a>
	  <a href="javascript:void(0);" class="icon" onclick="toggleMenu()">
	    <i class="fa fa-bars"></i>
	  </a>
	</div>
	<div class="container">
		<div class="row">
			<div>
					<h2>Home</h2>
					{% for post in posts %}
						<h2>{{ post.title }}</h2>
						<small>{{ post.author }}</small>
						<small>{{ post.date }}</small>
					    <p> {{ post.content }} </p>
					    {% for c in post.comments %}
							<div class="comment">
								<p><b><span>{{ c.author }}: </span></b>{{ c.content }}</p>
							</div>
					    {% endfor %}
					    <form action="/add-comment" method="post" class="comment-form">
							<textarea id="comment-input" name="content"></textarea>
							<input type="hidden" id="post-id" name="post-id" value="{{ post.id }}">
							<br>
							<div class="row" style="text-align: center;">
								<button type="button" id="save-btn">Save</button>
							</div>
					    </form>
					{% endfor %}
			</div>
		</div>
	</div>
	<div class="container">
		<div class="row">

		</div>
	</div>
	<script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
	<script src="{{ url_for('static', filename='js/sweetalert2.min.js') }}"></script>
	<script src="{{ url_for('static', filename='js/easy.js') }}"></script>
	<script src="{{ url_for('static', filename='js/tiny-date-picker.min.js') }}"></script>
	<script>
		$("#save-btn").click(function(e) {
			e.preventDefault();

			var fd = new FormData();
			var content = $( "#comment-input").val(); 
			fd.append('content', content);
			fd.append('post-id', $("#post-id").val());

			$.ajax({
			    type: 'POST',
			    url: '/add-comment',
			    data: fd,
			    contentType: false,
			    cache: false,
			    processData: false,
			    async: false,
			    success: function(data) {
					location.reload();
			    },
			    failure: function(data){
			        alert(data);
			    }
			});
		});

	</script>
</body>
</html>